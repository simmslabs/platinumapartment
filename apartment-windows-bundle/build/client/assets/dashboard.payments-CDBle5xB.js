import{u as E,a as N,j as e,F as m}from"./components-C4PRGKvj.js";import{u as g,D as I,B as u}from"./DashboardLayout-iJTv5ljA.js";import{S as x,T as R,a as n}from"./createReactComponent-DHQulasG.js";import{G as j}from"./Group-Di6LCSVE.js";import{B as i}from"./Button-BnDQv5QN.js";import{I as y,S as d}from"./IconPlus-s8q-TQuC.js";import{A as p}from"./Alert-j1ZULBv_.js";import{I as T}from"./IconInfoCircle-BZ-Vof_0.js";import{C as M}from"./IconBed-BsGsTKgU.js";import{T as s}from"./Table-BgFeYTs4.js";import{M as v}from"./Modal-DGehu6Yg.js";import{f as P}from"./format-Bu9WfNjO.js";import"./FocusTrap-jbxXVj5U.js";import"./use-id-CERWC921.js";import"./create-safe-context-C00InVMJ.js";import"./use-resolved-styles-api-Djkjaxcn.js";import"./InputBase-gTWN9iHu.js";import"./CloseButton-Dp9Chenx.js";const W=()=>[{title:"Payments - Apartment Management"},{name:"description",content:"Manage apartment payments"}];function X(){const{user:t,payments:f,unpaidBookings:c}=E(),a=N(),[A,{open:D,close:o}]=g(!1),b=r=>{switch(r){case"COMPLETED":return"green";case"PENDING":return"yellow";case"FAILED":return"red";case"REFUNDED":return"gray";default:return"gray"}},C=r=>{switch(r){case"CASH":return"green";case"CREDIT_CARD":return"blue";case"DEBIT_CARD":return"cyan";case"ONLINE":return"violet";case"BANK_TRANSFER":return"orange";default:return"gray"}};return e.jsx(I,{user:t,children:e.jsxs(x,{children:[e.jsxs(j,{justify:"space-between",children:[e.jsx(R,{order:2,children:"Payments Management"}),((t==null?void 0:t.role)==="ADMIN"||(t==null?void 0:t.role)==="MANAGER"||(t==null?void 0:t.role)==="STAFF")&&c.length>0&&e.jsx(i,{leftSection:e.jsx(y,{size:16}),onClick:D,children:"Record Payment"})]}),(a==null?void 0:a.error)&&e.jsx(p,{icon:e.jsx(T,{size:16}),title:"Error",color:"red",children:a.error}),(a==null?void 0:a.success)&&e.jsx(p,{icon:e.jsx(T,{size:16}),title:"Success",color:"green",children:a.success}),e.jsx(M,{children:e.jsxs(s,{striped:!0,highlightOnHover:!0,children:[e.jsx(s.Thead,{children:e.jsxs(s.Tr,{children:[e.jsx(s.Th,{children:"Guest"}),e.jsx(s.Th,{children:"Room"}),e.jsx(s.Th,{children:"Amount"}),e.jsx(s.Th,{children:"Method"}),e.jsx(s.Th,{children:"Status"}),e.jsx(s.Th,{children:"Transaction ID"}),e.jsx(s.Th,{children:"Paid Date"}),e.jsx(s.Th,{children:"Actions"})]})}),e.jsx(s.Tbody,{children:f.map(r=>e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:e.jsxs("div",{children:[e.jsxs(n,{fw:500,children:[r.booking.user.firstName," ",r.booking.user.lastName]}),e.jsx(n,{size:"sm",c:"dimmed",children:r.booking.user.email})]})}),e.jsx(s.Td,{children:e.jsxs(n,{fw:500,children:["Room ",r.booking.room.number]})}),e.jsx(s.Td,{children:e.jsxs(n,{fw:500,children:["$",r.amount]})}),e.jsx(s.Td,{children:e.jsx(u,{color:C(r.method),size:"sm",children:r.method.replace("_"," ")})}),e.jsx(s.Td,{children:e.jsx(u,{color:b(r.status),size:"sm",children:r.status})}),e.jsx(s.Td,{children:e.jsx(n,{size:"sm",c:"dimmed",children:r.transactionId||"N/A"})}),e.jsx(s.Td,{children:r.paidAt?P(new Date(r.paidAt),"MMM dd, yyyy"):"N/A"}),e.jsx(s.Td,{children:((t==null?void 0:t.role)==="ADMIN"||(t==null?void 0:t.role)==="MANAGER")&&e.jsxs(m,{method:"post",style:{display:"inline"},children:[e.jsx("input",{type:"hidden",name:"intent",value:"update-status"}),e.jsx("input",{type:"hidden",name:"paymentId",value:r.id}),e.jsx(d,{name:"status",size:"xs",data:[{value:"PENDING",label:"Pending"},{value:"COMPLETED",label:"Completed"},{value:"FAILED",label:"Failed"},{value:"REFUNDED",label:"Refunded"}],defaultValue:r.status,onChange:h=>{if(h){const l=new FormData;l.append("intent","update-status"),l.append("paymentId",r.id),l.append("status",h),fetch("/dashboard/payments",{method:"POST",body:l}).then(()=>window.location.reload())}}})]})})]},r.id))})]})}),e.jsx(v,{opened:A,onClose:o,title:"Record Payment",size:"lg",children:e.jsxs(m,{method:"post",children:[e.jsx("input",{type:"hidden",name:"intent",value:"create"}),e.jsxs(x,{children:[e.jsx(d,{label:"Booking",placeholder:"Select booking",name:"bookingId",data:c.map(r=>({value:r.id,label:`${r.user.firstName} ${r.user.lastName} - Room ${r.room.number} ($${r.totalAmount})`})),required:!0,searchable:!0}),e.jsx(d,{label:"Payment Method",placeholder:"Select method",name:"method",data:[{value:"CASH",label:"Cash"},{value:"CREDIT_CARD",label:"Credit Card"},{value:"DEBIT_CARD",label:"Debit Card"},{value:"ONLINE",label:"Online Payment"},{value:"BANK_TRANSFER",label:"Bank Transfer"}],required:!0}),e.jsxs(j,{justify:"flex-end",children:[e.jsx(i,{variant:"outline",onClick:o,children:"Cancel"}),e.jsx(i,{type:"submit",onClick:o,children:"Record Payment"})]})]})]})})]})})}export{X as default,W as meta};
