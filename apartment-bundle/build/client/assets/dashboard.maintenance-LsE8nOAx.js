import{u as A,a as v,j as e,F as h}from"./components-C4PRGKvj.js";import{u as N,D as S,B as u,I as R}from"./DashboardLayout-iJTv5ljA.js";import{S as x,T as D,a as n}from"./createReactComponent-DHQulasG.js";import{G as l}from"./Group-Di6LCSVE.js";import{B as d}from"./Button-BnDQv5QN.js";import{I as P,S as o}from"./IconPlus-s8q-TQuC.js";import{A as j}from"./Alert-j1ZULBv_.js";import{I as T}from"./IconInfoCircle-BZ-Vof_0.js";import{C as w}from"./IconBed-BsGsTKgU.js";import{T as s}from"./Table-BgFeYTs4.js";import{f as L}from"./format-Bu9WfNjO.js";import{M as z}from"./Modal-DGehu6Yg.js";import{T as m,N as G}from"./NumberInput-DLSkAwXW.js";import"./FocusTrap-jbxXVj5U.js";import"./use-id-CERWC921.js";import"./create-safe-context-C00InVMJ.js";import"./use-resolved-styles-api-Djkjaxcn.js";import"./InputBase-gTWN9iHu.js";import"./CloseButton-Dp9Chenx.js";import"./objectWithoutPropertiesLoose-Cv5OCJ0e.js";const se=()=>[{title:"Maintenance - Apartment Management"},{name:"description",content:"Manage apartment maintenance tasks"}];function ae(){const{user:a,maintenanceLogs:y,rooms:b}=A(),t=v(),[f,{open:I,close:c}]=N(!1),C=r=>{switch(r){case"PENDING":return"yellow";case"IN_PROGRESS":return"blue";case"COMPLETED":return"green";case"CANCELLED":return"red";default:return"gray"}},E=r=>{switch(r){case"LOW":return"green";case"MEDIUM":return"yellow";case"HIGH":return"orange";case"CRITICAL":return"red";default:return"gray"}},M=r=>e.jsx(R,{size:16});return e.jsx(S,{user:a,children:e.jsxs(x,{children:[e.jsxs(l,{justify:"space-between",children:[e.jsx(D,{order:2,children:"Maintenance Management"}),((a==null?void 0:a.role)==="ADMIN"||(a==null?void 0:a.role)==="MANAGER"||(a==null?void 0:a.role)==="STAFF")&&e.jsx(d,{leftSection:e.jsx(P,{size:16}),onClick:I,children:"New Maintenance Task"})]}),(t==null?void 0:t.error)&&e.jsx(j,{icon:e.jsx(T,{size:16}),title:"Error",color:"red",children:t.error}),(t==null?void 0:t.success)&&e.jsx(j,{icon:e.jsx(T,{size:16}),title:"Success",color:"green",children:t.success}),e.jsx(w,{children:e.jsxs(s,{striped:!0,highlightOnHover:!0,children:[e.jsx(s.Thead,{children:e.jsxs(s.Tr,{children:[e.jsx(s.Th,{children:"Room"}),e.jsx(s.Th,{children:"Type"}),e.jsx(s.Th,{children:"Description"}),e.jsx(s.Th,{children:"Priority"}),e.jsx(s.Th,{children:"Status"}),e.jsx(s.Th,{children:"Reported"}),e.jsx(s.Th,{children:"Cost"}),e.jsx(s.Th,{children:"Actions"})]})}),e.jsx(s.Tbody,{children:y.map(r=>e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:e.jsxs("div",{children:[e.jsxs(n,{fw:500,children:["Room ",r.room.number]}),e.jsx(n,{size:"sm",c:"dimmed",children:r.room.type.replace("_"," ")})]})}),e.jsx(s.Td,{children:e.jsxs(l,{gap:"xs",children:[M(r.type),e.jsx(n,{size:"sm",children:r.type.replace("_"," ")})]})}),e.jsx(s.Td,{children:e.jsx(n,{size:"sm",lineClamp:2,children:r.description})}),e.jsx(s.Td,{children:e.jsx(u,{color:E(r.priority),size:"sm",children:r.priority})}),e.jsx(s.Td,{children:e.jsx(u,{color:C(r.status),size:"sm",children:r.status.replace("_"," ")})}),e.jsx(s.Td,{children:e.jsxs("div",{children:[e.jsx(n,{size:"sm",children:L(new Date(r.createdAt),"MMM dd, yyyy")}),r.reportedBy&&e.jsxs(n,{size:"xs",c:"dimmed",children:["by ",r.reportedBy]})]})}),e.jsx(s.Td,{children:r.cost?`$${r.cost}`:"N/A"}),e.jsx(s.Td,{children:((a==null?void 0:a.role)==="ADMIN"||(a==null?void 0:a.role)==="MANAGER"||(a==null?void 0:a.role)==="STAFF")&&e.jsxs(h,{method:"post",style:{display:"inline"},children:[e.jsx("input",{type:"hidden",name:"intent",value:"update-status"}),e.jsx("input",{type:"hidden",name:"maintenanceId",value:r.id}),e.jsx(o,{name:"status",size:"xs",data:[{value:"PENDING",label:"Pending"},{value:"IN_PROGRESS",label:"In Progress"},{value:"COMPLETED",label:"Completed"},{value:"CANCELLED",label:"Cancelled"}],defaultValue:r.status,onChange:p=>{if(p){const i=new FormData;i.append("intent","update-status"),i.append("maintenanceId",r.id),i.append("status",p),fetch("/dashboard/maintenance",{method:"POST",body:i}).then(()=>window.location.reload())}}})]})})]},r.id))})]})}),e.jsx(z,{opened:f,onClose:c,title:"Create Maintenance Task",size:"lg",children:e.jsxs(h,{method:"post",children:[e.jsx("input",{type:"hidden",name:"intent",value:"create"}),e.jsxs(x,{children:[e.jsx(o,{label:"Room",placeholder:"Select room",name:"roomId",data:b.map(r=>({value:r.id,label:`Room ${r.number} - ${r.type.replace("_"," ")}`})),required:!0,searchable:!0}),e.jsx(o,{label:"Maintenance Type",placeholder:"Select type",name:"type",data:[{value:"CLEANING",label:"Cleaning"},{value:"REPAIR",label:"Repair"},{value:"INSPECTION",label:"Inspection"},{value:"UPGRADE",label:"Upgrade"},{value:"PREVENTIVE",label:"Preventive"}],required:!0}),e.jsx(m,{label:"Description",placeholder:"Describe the maintenance task...",name:"description",required:!0,rows:3}),e.jsx(o,{label:"Priority",placeholder:"Select priority",name:"priority",data:[{value:"LOW",label:"Low"},{value:"MEDIUM",label:"Medium"},{value:"HIGH",label:"High"},{value:"CRITICAL",label:"Critical"}],required:!0}),e.jsxs(l,{grow:!0,children:[e.jsx(m,{label:"Reported By",placeholder:"Staff member name",name:"reportedBy",rows:1}),e.jsx(m,{label:"Assigned To",placeholder:"Maintenance staff",name:"assignedTo",rows:1})]}),e.jsx(G,{label:"Estimated Cost",placeholder:"100",name:"cost",min:0,prefix:"$",decimalScale:2}),e.jsxs(l,{justify:"flex-end",children:[e.jsx(d,{variant:"outline",onClick:c,children:"Cancel"}),e.jsx(d,{type:"submit",onClick:c,children:"Create Task"})]})]})]})})]})})}export{ae as default,se as meta};
