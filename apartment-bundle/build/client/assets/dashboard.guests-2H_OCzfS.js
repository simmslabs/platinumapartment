import{u as q,a as B,r as u,j as e,F as b}from"./components-C4PRGKvj.js";import{u as v,D as O,B as H}from"./DashboardLayout-iJTv5ljA.js";import{c as P,S as x,T as K,a as i}from"./createReactComponent-DHQulasG.js";import{G as n}from"./Group-Di6LCSVE.js";import{B as m}from"./Button-BnDQv5QN.js";import{I as V,S as J}from"./IconPlus-s8q-TQuC.js";import{A as N}from"./Alert-j1ZULBv_.js";import{I as g}from"./IconInfoCircle-BZ-Vof_0.js";import{C as E}from"./IconBed-BsGsTKgU.js";import{T as a}from"./TextInput-BnXTk2f9.js";import{I as Q}from"./IconSearch-CCM7Vt_l.js";import{T as r}from"./Table-BgFeYTs4.js";import{A as T}from"./ActionIcon-CuT3bTp5.js";import{I as U}from"./IconTrash-BkbOyWXp.js";import{M as A}from"./Modal-DGehu6Yg.js";import{f as I}from"./format-Bu9WfNjO.js";import"./FocusTrap-jbxXVj5U.js";import"./use-id-CERWC921.js";import"./create-safe-context-C00InVMJ.js";import"./use-resolved-styles-api-Djkjaxcn.js";import"./InputBase-gTWN9iHu.js";import"./CloseButton-Dp9Chenx.js";/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1",key:"svg-0"}],["path",{d:"M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z",key:"svg-1"}],["path",{d:"M16 5l3 3",key:"svg-2"}]],X=P("outline","edit","Edit",W),Ce=()=>[{title:"Guests - Apartment Management"},{name:"description",content:"Manage apartment guests"}];function be(){const{user:t,guests:p}=q(),c=B(),[w,{open:M,close:j}]=v(!1),[D,{open:k,close:f}]=v(!1),[o,G]=u.useState(null),[d,S]=u.useState(""),[h,z]=u.useState("all"),y=u.useMemo(()=>p.filter(l=>{const R=l.firstName.toLowerCase().includes(d.toLowerCase())||l.lastName.toLowerCase().includes(d.toLowerCase())||l.email.toLowerCase().includes(d.toLowerCase())||l.phone&&l.phone.toLowerCase().includes(d.toLowerCase()),_=h==="all"||h==="active"&&l.bookings.some(C=>["CONFIRMED","CHECKED_IN"].includes(C.status))||h==="inactive"&&!l.bookings.some(C=>["CONFIRMED","CHECKED_IN"].includes(C.status));return R&&_}),[p,d,h]),L=s=>{G(s),k()},F=s=>{switch(s){case"CONFIRMED":return"green";case"PENDING":return"yellow";case"CHECKED_IN":return"blue";case"CHECKED_OUT":return"gray";case"CANCELLED":return"red";default:return"gray"}};return e.jsx(O,{user:t,children:e.jsxs(x,{children:[e.jsxs(n,{justify:"space-between",children:[e.jsx(K,{order:2,children:"Guests Management"}),((t==null?void 0:t.role)==="ADMIN"||(t==null?void 0:t.role)==="MANAGER")&&e.jsx(m,{leftSection:e.jsx(V,{size:16}),onClick:M,children:"Add Guest"})]}),c&&"error"in c&&e.jsx(N,{icon:e.jsx(g,{size:16}),title:"Error",color:"red",children:c.error}),c&&"success"in c&&e.jsx(N,{icon:e.jsx(g,{size:16}),title:"Success",color:"green",children:c.success}),e.jsx(E,{children:e.jsxs(n,{children:[e.jsx(a,{placeholder:"Search guests...",leftSection:e.jsx(Q,{size:16}),value:d,onChange:s=>S(s.currentTarget.value),style:{flexGrow:1}}),e.jsx(J,{placeholder:"Filter by status",value:h,onChange:s=>z(s||"all"),data:[{value:"all",label:"All Guests"},{value:"active",label:"Active Guests"},{value:"inactive",label:"Inactive Guests"}],style:{minWidth:150}})]})}),e.jsxs(E,{children:[e.jsx(n,{justify:"space-between",mb:"md",children:e.jsxs(i,{size:"sm",c:"dimmed",children:["Showing ",y.length," of ",p.length," guests"]})}),e.jsxs(r,{striped:!0,highlightOnHover:!0,children:[e.jsx(r.Thead,{children:e.jsxs(r.Tr,{children:[e.jsx(r.Th,{children:"Guest Information"}),e.jsx(r.Th,{children:"Contact"}),e.jsx(r.Th,{children:"Total Bookings"}),e.jsx(r.Th,{children:"Latest Booking"}),e.jsx(r.Th,{children:"Joined"}),((t==null?void 0:t.role)==="ADMIN"||(t==null?void 0:t.role)==="MANAGER")&&e.jsx(r.Th,{children:"Actions"})]})}),e.jsx(r.Tbody,{children:y.length===0?e.jsx(r.Tr,{children:e.jsx(r.Td,{colSpan:6,style:{textAlign:"center",padding:"2rem"},children:e.jsxs(x,{align:"center",gap:"sm",children:[e.jsx(g,{size:48,color:"gray"}),e.jsx(i,{c:"dimmed",children:d||h!=="all"?"No guests found matching your criteria":"No guests available"})]})})}):y.map(s=>e.jsxs(r.Tr,{children:[e.jsx(r.Td,{children:e.jsxs("div",{children:[e.jsxs(i,{fw:500,children:[s.firstName," ",s.lastName]}),e.jsx(i,{size:"sm",c:"dimmed",children:s.email})]})}),e.jsx(r.Td,{children:e.jsxs("div",{children:[s.phone&&e.jsx(i,{size:"sm",children:s.phone}),s.address&&e.jsx(i,{size:"sm",c:"dimmed",children:s.address})]})}),e.jsx(r.Td,{children:e.jsx(i,{fw:500,children:s.bookings.length})}),e.jsx(r.Td,{children:s.bookings.length>0?e.jsxs("div",{children:[e.jsx(H,{color:F(s.bookings[0].status),size:"sm",children:s.bookings[0].status.replace("_"," ")}),e.jsx(i,{size:"sm",c:"dimmed",children:I(new Date(s.bookings[0].checkIn),"MMM dd, yyyy")})]}):e.jsx(i,{size:"sm",c:"dimmed",children:"No bookings"})}),e.jsx(r.Td,{children:I(new Date(s.createdAt),"MMM dd, yyyy")}),((t==null?void 0:t.role)==="ADMIN"||(t==null?void 0:t.role)==="MANAGER")&&e.jsx(r.Td,{children:e.jsxs(n,{gap:"xs",children:[e.jsx(T,{variant:"subtle",color:"blue",onClick:()=>L(s),children:e.jsx(X,{size:16})}),e.jsxs(b,{method:"post",style:{display:"inline"},children:[e.jsx("input",{type:"hidden",name:"intent",value:"delete"}),e.jsx("input",{type:"hidden",name:"guestId",value:s.id}),e.jsx(T,{variant:"subtle",color:"red",type:"submit",onClick:l=>{confirm("Are you sure you want to delete this guest?")||l.preventDefault()},children:e.jsx(U,{size:16})})]})]})})]},s.id))})]})]}),e.jsx(A,{opened:w,onClose:j,title:"Add New Guest",size:"lg",children:e.jsxs(b,{method:"post",children:[e.jsx("input",{type:"hidden",name:"intent",value:"create"}),e.jsxs(x,{children:[e.jsxs(n,{grow:!0,children:[e.jsx(a,{label:"First Name",placeholder:"John",name:"firstName",required:!0}),e.jsx(a,{label:"Last Name",placeholder:"Doe",name:"lastName",required:!0})]}),e.jsx(a,{label:"Email",placeholder:"john.doe@example.com",name:"email",type:"email",required:!0}),e.jsx(a,{label:"Password",placeholder:"Enter password",name:"password",type:"password",required:!0}),e.jsx(a,{label:"Phone",placeholder:"+1234567890",name:"phone"}),e.jsx(a,{label:"Address",placeholder:"123 Main Street, City",name:"address"}),e.jsxs(n,{justify:"flex-end",children:[e.jsx(m,{variant:"outline",onClick:j,children:"Cancel"}),e.jsx(m,{type:"submit",onClick:j,children:"Add Guest"})]})]})]})}),e.jsx(A,{opened:D,onClose:f,title:"Edit Guest",size:"lg",children:o&&e.jsxs(b,{method:"post",children:[e.jsx("input",{type:"hidden",name:"intent",value:"update"}),e.jsx("input",{type:"hidden",name:"guestId",value:o.id}),e.jsxs(x,{children:[e.jsxs(n,{grow:!0,children:[e.jsx(a,{label:"First Name",placeholder:"John",name:"firstName",defaultValue:o.firstName,required:!0}),e.jsx(a,{label:"Last Name",placeholder:"Doe",name:"lastName",defaultValue:o.lastName,required:!0})]}),e.jsx(a,{label:"Email",value:o.email,disabled:!0,description:"Email cannot be changed"}),e.jsx(a,{label:"Phone",placeholder:"+1234567890",name:"phone",defaultValue:o.phone||""}),e.jsx(a,{label:"Address",placeholder:"123 Main Street, City",name:"address",defaultValue:o.address||""}),e.jsxs(n,{justify:"flex-end",children:[e.jsx(m,{variant:"outline",onClick:f,children:"Cancel"}),e.jsx(m,{type:"submit",onClick:f,children:"Update Guest"})]})]})]})})]})})}export{be as default,Ce as meta};
